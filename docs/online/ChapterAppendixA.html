<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.28">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Appendix A — Some Useful Matrix-Algebra Definitions and Properties – Spatio-Temporal Statistics with R (1st edition)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ChapterAppendixB.html" rel="next">
<link href="./references.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-b719d3d4935f2b08311a76135e2bf442.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-7d2e1f8220df954187ab24ed36a0da9c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/foldbox/foldbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>
.Algorithm {
  --color1: #948bde;
  --color2: #584eab;
}
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ChapterAppendixA.html">Appendices</a></li><li class="breadcrumb-item"><a href="./ChapterAppendixA.html"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Some Useful Matrix-Algebra Definitions and Properties</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Spatio-Temporal Statistics with R (1st edition)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Spatio-Temporal Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Exploring Spatio-Temporal Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Spatio-Temporal Statistical Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Descriptive Spatio-Temporal Statistical Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Dynamic Spatio-Temporal Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Evaluating Spatio-Temporal Statistical Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ChapterPergimus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pergimus (Epilogue)</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ChapterAppendixA.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Some Useful Matrix-Algebra Definitions and Properties</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ChapterAppendixB.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">General Smoothing Kernels</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ChapterAppendixC.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Estimation and Prediction for Dynamic Spatio-Temporal Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ChapterAppendixD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Mechanistically Motivated Dynamic Spatio-Temporal Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ChapterAppendixE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Case Study: Physical-Statistical Bayesian Hierarchical Model for Predicting Mediterranean Surface Winds</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ChapterAppendixF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Case Study: Quadratic Echo State Networks for Sea Surface Temperature Long-Lead Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
  <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ChapterRPackages.html" class="sidebar-item-text sidebar-link">
  <span class="menu-text">List of <code>R</code> packages</span></a>
  </div>
  </li>
  <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
  <span class="menu-text">References</span></a>
  </div>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ChapterAppendixA.html">Appendices</a></li><li class="breadcrumb-item"><a href="./ChapterAppendixA.html"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Some Useful Matrix-Algebra Definitions and Properties</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-matrixalgebra" class="quarto-section-identifier">Appendix A — Some Useful Matrix-Algebra Definitions and Properties</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>For the sake of completeness, we provide some definitions and properties of vectors and matrices that are needed to understand many of the formulas and equations in this book. Readers who are already familiar with matrix algebra can skip this section. Readers who would like more detail than the bare minimum presented here can find them in books on matrix algebra or multivariate statistics (e.g., <span class="citation" data-cites="johnson1992applied">Johnson &amp; Wichern (<a href="references.html#ref-johnson1992applied" role="doc-biblioref">1992</a>)</span>, <span class="citation" data-cites="schott2016matrix">Schott (<a href="references.html#ref-schott2016matrix" role="doc-biblioref">2017</a>)</span>).</p>
<p><strong>Vectors and matrices</strong>. In this book we denote a <em>vector</em> (a column of numbers) by a bold letter (Latin or Greek); for example,</p>
<p><span class="math display">\[
{\mathbf{a}} = \left[\begin{array}{c} a_1 \\ a_2\\ \vdots \\ a_p \end{array} \right]
\]</span></p>
<p>represents a <span class="math inline">\(p\)</span>-dimensional vector, and <span class="math inline">\({\mathbf{a}}' = [a_1, a_2, \ldots, a_p]\)</span> or <span class="math inline">\((a_1, a_2,\ldots,a_p)\)</span> is its <span class="math inline">\(p\)</span>-dimensional transpose.</p>
<p>We also denote a <em>matrix</em> (an array of numbers) by bold upper-case letters (Latin or Greek); for example,</p>
<p><span class="math display">\[
{\mathbf{A}} = \left[ \begin{array}{cccc}
a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1n} \\
a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2n} \\
\vdots &amp; \vdots &amp; \; &amp; \vdots \\
a_{p1} &amp; a_{p2} &amp; \cdots &amp; a_{pn} \\
\end{array}\right]
\]</span></p>
<p>is a <span class="math inline">\(p \times n\)</span> matrix, and <span class="math inline">\(a_{k \ell}\)</span> corresponds to the element in the <span class="math inline">\(k\)</span>th row and <span class="math inline">\(\ell\)</span>th column; sometimes it is also written as <span class="math inline">\(\{a_{k \ell}\}\)</span>. The matrix transpose, <span class="math inline">\(\mathbf{A}'\)</span>, is then an <span class="math inline">\(n \times p\)</span> matrix given by</p>
<p><span class="math display">\[
{\mathbf{A}}' = \left[ \begin{array}{cccc}
a_{11} &amp; a_{21} &amp; \cdots &amp; a_{p1} \\
a_{12} &amp; a_{22} &amp; \cdots &amp; a_{p2} \\
\vdots &amp; \vdots &amp; \; &amp; \vdots \\
a_{1n} &amp; a_{2n} &amp; \cdots &amp; a_{pn} \\
\end{array}\right].
\]</span></p>
<p>We often consider a special matrix known as the <em>identity matrix</em>, denoted <span class="math inline">\(\mathbf{I}_n\)</span>, which is an <span class="math inline">\(n \times n\)</span> diagonal matrix with ones along the main diagonal (i.e., <span class="math inline">\(a_{ii}=1\)</span> for <span class="math inline">\(i=1,\ldots,n\)</span>) and zeros for all of the off-diagonal elements (i.e., <span class="math inline">\(a_{ij} = 0, \mbox{for } i \neq j\)</span>). It is sometimes the case that the dimensional subscript (in this case, <span class="math inline">\(n\)</span>) is left off if the context is clear.</p>
<p>Finally, note that a vector can be thought of as a special case of a <span class="math inline">\(p \times n\)</span> matrix, where either <span class="math inline">\(p=1\)</span> or <span class="math inline">\(n=1\)</span>.</p>
<p><strong>Matrix addition</strong>. Matrix addition is defined for two matrices that have the same dimension. Then, given <span class="math inline">\(p \times n\)</span> matrices <span class="math inline">\(\mathbf{A}\)</span> and <span class="math inline">\(\mathbf{B}\)</span>, with elements <span class="math inline">\(\{a_{k \ell}\}\)</span> and <span class="math inline">\(\{b_{k \ell}\}\)</span> for <span class="math inline">\(k=1,\ldots,p\)</span> and <span class="math inline">\(\ell = 1,\ldots,n\)</span>, respectively, the elements of the matrix sum, <span class="math inline">\(\mathbf{C}= \{c_{k \ell}\} = \mathbf{A}+ \mathbf{B}\)</span>, are given by</p>
<p><span class="math display">\[
c_{k \ell} = a_{k \ell} + b_{k \ell}, \quad k=1,\ldots,p;\ \ell = 1,\ldots,n.
\]</span></p>
<p><strong>Scalar multiplication</strong>. Consider an arbitrary scalar, <span class="math inline">\(c\)</span>, and the <span class="math inline">\(p \times n\)</span> matrix <span class="math inline">\(\mathbf{A}\)</span>. Scalar multiplication by a matrix then gives a new matrix in which each element of the matrix <span class="math inline">\(\mathbf{A}\)</span> is multiplied individually by the scalar <span class="math inline">\(c\)</span>. Specifically, <span class="math inline">\(c \mathbf{A}= \mathbf{A}c = \mathbf{G}\)</span>, where each element of <span class="math inline">\(\mathbf{G}= \{g_{k \ell}\}\)</span> is given by <span class="math inline">\(g_{k \ell} = c a_{k \ell}\)</span>, for <span class="math inline">\(k=1,\ldots,p\)</span> and <span class="math inline">\(\ell = 1,\ldots,n\)</span>.</p>
<p><strong>Matrix subtraction</strong>. As with matrix addition, matrix subtraction is defined for two matrices that have the same dimension. Consider the two <span class="math inline">\(p \times n\)</span> matrices <span class="math inline">\(\mathbf{A}\)</span> and <span class="math inline">\(\mathbf{B}\)</span>, with elements <span class="math inline">\(\{a_{k \ell}\}\)</span> and <span class="math inline">\(\{b_{k \ell}\}\)</span>, for <span class="math inline">\(k=1,\ldots,p\)</span> and <span class="math inline">\(\ell = 1,\ldots,n\)</span>, respectively. The matrix difference between <span class="math inline">\(\mathbf{A}\)</span> and <span class="math inline">\(\mathbf{B}\)</span> is then given by <span class="math display">\[
\mathbf{C}= \{c_{k \ell}\} = \mathbf{A}- \mathbf{B}= \mathbf{A}+ (-1)\mathbf{B},
\]</span> where it can be seen that the elements of <span class="math inline">\(\mathbf{C}\)</span> are given by <span class="math inline">\(c_{k \ell} = a_{k \ell} - b_{k \ell}\)</span>, for <span class="math inline">\(k=1,\ldots,p\)</span> and <span class="math inline">\(\ell = 1,\ldots,n\)</span>. Thus, matrix subtraction is just a combination of matrix addition and scalar multiplication (by <span class="math inline">\(- 1\)</span>).</p>
<p><strong>Matrix multiplication</strong>. The product of the <span class="math inline">\(p \times n\)</span> matrix <span class="math inline">\(\mathbf{A}\)</span> and <span class="math inline">\(n \times m\)</span> matrix <span class="math inline">\(\mathbf{B}\)</span> is given by the <span class="math inline">\(p \times m\)</span> matrix <span class="math inline">\(\mathbf{C}\)</span>, where <span class="math inline">\(\mathbf{C}= \{c_{kj}\} = \mathbf{A}\mathbf{B}\)</span>, with <span class="math display">\[
c_{kj} = \sum_{\ell = 1}^n a_{k \ell} b_{\ell j}, \quad k=1,\ldots,p;\ j=1,\ldots,m.
\]</span> Thus, for the matrix product <span class="math inline">\(\mathbf{A}\mathbf{B}\)</span> to exist, the number of columns in <span class="math inline">\(\mathbf{A}\)</span> must equal the number of rows in <span class="math inline">\(\mathbf{B}\)</span>; so <span class="math inline">\(\mathbf{C}\)</span> always has the number of rows that are in <span class="math inline">\(\mathbf{A}\)</span> and the number of columns that are in <span class="math inline">\(\mathbf{B}\)</span>.</p>
<p><strong>Orthogonal matrix</strong>. A square <span class="math inline">\(p \times p\)</span> matrix <span class="math inline">\(\mathbf{A}\)</span> is said to be <em>orthogonal</em> if <span class="math inline">\(\mathbf{A}\mathbf{A}' = \mathbf{A}' \mathbf{A}= \mathbf{I}_p\)</span>.</p>
<p><strong>Vector inner product</strong>. As a special case of matrix multiplication, consider two vectors, <span class="math inline">\(\mathbf{a}\)</span> and <span class="math inline">\(\mathbf{b}\)</span>, both of length <span class="math inline">\(p\)</span>. The <em>inner product</em> of <span class="math inline">\(\mathbf{a}\)</span> and <span class="math inline">\(\mathbf{b}\)</span> is given by the scalar <span class="math inline">\(\mathbf{a}' \mathbf{b}= \mathbf{b}' \mathbf{a}\equiv \sum_{k=1}^p a_k b_k\)</span>.</p>
<p><strong>Vector outer product</strong>. For another special case of matrix multiplication, consider a <span class="math inline">\(p\)</span>-dimensional vector <span class="math inline">\(\mathbf{a}\)</span> and a <span class="math inline">\(q\)</span>-dimensional vector <span class="math inline">\(\mathbf{b}\)</span>. The <em>outer product</em> <span class="math inline">\(\mathbf{a}\mathbf{b}'\)</span> is given by the <span class="math inline">\(p \times q\)</span> matrix <span class="math display">\[
\mathbf{a}\mathbf{b}' \equiv
\left[ \begin{array}{cccc}
a_{1} b_{1} &amp; a_{1} b_2 &amp; \cdots &amp; a_1 b_q \\
a_{2} b_1 &amp; a_{2} b_2 &amp; \cdots &amp; a_2 b_q \\
\vdots &amp; \vdots &amp; \; &amp; \vdots \\
a_{p} b_1 &amp; a_{p} b_2 &amp; \cdots &amp; a_{p} b_q \\
\end{array}\right].
\]</span> Note that (in general) <span class="math inline">\(\mathbf{a}\mathbf{b}' \neq \mathbf{b}' \mathbf{a}\)</span>.</p>
<p><strong>Kronecker product</strong>. Consider two matrices, an <span class="math inline">\(n_a \times m_a\)</span> matrix, <span class="math inline">\(\mathbf{A}\)</span>, and an <span class="math inline">\(n_b \times m_b\)</span> matrix, <span class="math inline">\(\mathbf{B}\)</span>. The Kronecker product of <span class="math inline">\(\mathbf{A}\)</span> and <span class="math inline">\(\mathbf{B}\)</span> is given by the <span class="math inline">\(n_a n_b \times m_a m_b\)</span> matrix <span class="math inline">\(\mathbf{A}\otimes \mathbf{B}\)</span> defined as <span class="math display">\[
\mathbf{A}\otimes \mathbf{B}\equiv \left[\begin{array}{ccc}
a_{11} \mathbf{B}&amp; \cdots &amp; a_{1 m_a} \mathbf{B}\\
\vdots &amp; \vdots &amp; \vdots \\
a_{n_a 1} \mathbf{B}&amp; \cdots &amp; a_{n_a m_a} \mathbf{B}
\end{array}\right].
\]</span> If <span class="math inline">\(\mathbf{A}\)</span> is <span class="math inline">\(n_a \times n_a\)</span> and <span class="math inline">\(\mathbf{B}\)</span> is <span class="math inline">\(n_b \times n_b\)</span>, the inverse and determinant of the Kronecker product can be expressed in terms of the Kronecker product of the inverses and determinants of the individual matrices, respectively: <span class="math display">\[
(\mathbf{A}\otimes \mathbf{B})^{-1} = \mathbf{A}^{-1} \otimes \mathbf{B}^{-1},
\]</span> <span class="math display">\[
|\mathbf{A}\otimes \mathbf{B}| = |\mathbf{A}|^{n_b} \;  |\mathbf{B}|^{n_a}.
\]</span></p>
<p><strong>Euclidean norm</strong>. Consider the <span class="math inline">\(p\)</span>-dimensional real-valued vector <span class="math inline">\(\mathbf{a}= [a_1,a_2,\ldots,a_p]'\)</span>. The Euclidean norm is simply the Euclidean distance in <span class="math inline">\(p\)</span>-dimensional space, given by</p>
<p><span class="math display">\[
||\mathbf{a}|| \equiv  \sqrt{\mathbf{a}' \mathbf{a}} \equiv \sqrt{\sum_{k=1}^p a^2_{k}}.
\]</span></p>
<p><strong>Symmetric matrix</strong>. A matrix <span class="math inline">\(\mathbf{A}\)</span> is said to be <em>symmetric</em> if <span class="math inline">\(\mathbf{A}' = \mathbf{A}\)</span>.</p>
<p><strong>Diagonal matrix</strong>. Consider the <span class="math inline">\(p \times p\)</span> matrix <span class="math inline">\(\mathbf{A}\)</span>. The (main) diagonal elements of this matrix are given by the vector <span class="math inline">\([a_{11},a_{22},\ldots,a_{pp}]'\)</span>. Sometimes it is helpful to use a shorthand notation to construct a matrix with specific elements of a vector on the main diagonal and zeros for all other elements. For example,</p>
<p><span class="math display">\[
\textrm{diag}(b_1,b_2,\ldots,b_q) \equiv
\left[ \begin{array}{ccccc}
b_{1}  &amp; 0  &amp; 0 &amp; \cdots &amp; 0\\
  0 &amp; b_2 &amp; 0 &amp;\cdots &amp; 0 \\
  \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
   0 &amp; 0 &amp; 0 &amp;\cdots &amp;  b_q \\
\end{array}\right].
\]</span></p>
<p><strong>Trace of a matrix</strong>. Let <span class="math inline">\(\mathbf{A}\)</span> be a <span class="math inline">\(p \times p\)</span> square matrix. We then define the <em>trace</em> of this matrix, denoted <span class="math inline">\(\textrm{trace}(\mathbf{A})\)</span> (or <span class="math inline">\(\text{tr}(\mathbf{A})\)</span>) as the sum of the diagonal elements of <span class="math inline">\(\mathbf{A}\)</span>; that is,</p>
<p><span class="math display">\[
\textrm{trace}(\mathbf{A}) = \sum_{k=1}^p a_{kk}.
\]</span></p>
<p><strong>Non-negative-definite and positive-definite matrices</strong>. Consider a <span class="math inline">\(p \times p\)</span> symmetric and real-valued matrix, <span class="math inline">\(\mathbf{A}\)</span>. If, for any non-zero real-valued vector <span class="math inline">\(\mathbf{x}\)</span>, the scalar given by the <em>quadratic form</em> <span class="math inline">\(\mathbf{x}' \mathbf{A}\mathbf{x}\)</span> is non-negative, we say <span class="math inline">\(\mathbf{A}\)</span> is a <em>non-negative-definite</em> matrix. Similarly, if <span class="math inline">\(\mathbf{x}' \mathbf{A}\mathbf{x}\)</span> is strictly positive for any <span class="math inline">\(\mathbf{x}\neq {\mathbf{0}}\)</span>, we say that <span class="math inline">\(\mathbf{A}\)</span> is a <em>positive-definite</em> matrix.</p>
<p><strong>Matrix inverse</strong>. Consider the <span class="math inline">\(p \times p\)</span> square matrix, <span class="math inline">\(\mathbf{A}\)</span>. If it exists, the matrix <span class="math inline">\(\mathbf{B}\)</span> such that <span class="math inline">\(\mathbf{A}\mathbf{B}= \mathbf{B}\mathbf{A}= \mathbf{I}_p\)</span> is known as the <em>inverse matrix</em> of <span class="math inline">\(\mathbf{A}\)</span>, and it is denoted by <span class="math inline">\(\mathbf{A}^{-1}\)</span>. Thus, <span class="math inline">\(\mathbf{A}^{-1} \mathbf{A}= \mathbf{A}\mathbf{A}^{-1} = \mathbf{I}_p\)</span>. If the inverse exists, we say that the matrix is <em>invertible</em>. Not every square matrix has an inverse, but every positive-definite matrix is invertible (and, the inverse matrix is also positive-definite).</p>
<p><strong>Matrix square root</strong>. Let <span class="math inline">\(\mathbf{A}\)</span> be a <span class="math inline">\(p \times p\)</span> positive-definite matrix. Then there exists a matrix <span class="math inline">\(\mathbf{B}\)</span> such that <span class="math inline">\(\mathbf{A}= \mathbf{B}\mathbf{B}\equiv \mathbf{B}^2\)</span> and we say that <span class="math inline">\(\mathbf{B}\)</span> is the <em>matrix square root</em> of <span class="math inline">\(\mathbf{A}\)</span> and denote it by <span class="math inline">\(\mathbf{A}^{1/2}\)</span>. The matrix square root of a positive-definite matrix is also positive-definite and we can write the inverse matrix as <span class="math inline">\(\mathbf{A}^{-1} = \mathbf{A}^{-1/2} \mathbf{A}^{-1/2}\)</span>, where <span class="math inline">\(\mathbf{A}^{-1/2}\)</span> is the inverse of <span class="math inline">\(\mathbf{A}^{1/2}\)</span>.</p>
<p><strong>Spectral decomposition</strong>. Let <span class="math inline">\(\mathbf{A}\)</span> be a <span class="math inline">\(p \times p\)</span> symmetric matrix of real values. This matrix can be decomposed as <span class="math display">\[
\mathbf{A}= \sum_{k=1}^p \lambda_k \boldsymbol{\phi}_k \boldsymbol{\phi}_k' = \boldsymbol{\Phi}\boldsymbol{\Lambda}\boldsymbol{\Phi}',
\]</span> where <span class="math inline">\(\boldsymbol{\Lambda}= \textrm{diag}(\lambda_1,\ldots,\lambda_p)\)</span>, <span class="math inline">\(\boldsymbol{\Phi}= [\boldsymbol{\phi}_1,\ldots,\boldsymbol{\phi}_p]\)</span>, and <span class="math inline">\(\{\lambda_k\}\)</span> are called the <em>eigenvalues</em> that are associated with the <em>eigenvectors</em>, <span class="math inline">\(\{\boldsymbol{\phi}_k\}\)</span>, <span class="math inline">\(k=1,\ldots,p\)</span>, which are orthogonal (i.e., <span class="math inline">\(\boldsymbol{\Phi}\boldsymbol{\Phi}' = \boldsymbol{\Phi}' \boldsymbol{\Phi}= \mathbf{I}_p\)</span>). Note that for a symmetric non-negative-definite matrix <span class="math inline">\(\mathbf{A}\)</span>, <span class="math inline">\(\lambda_k \ge 0\)</span>, and for a symmetric positive-definite matrix <span class="math inline">\(\mathbf{A}\)</span>, <span class="math inline">\(\lambda_k &gt; 0\)</span>, for all <span class="math inline">\(k = 1,\ldots,p\)</span>. The matrix square root and its inverse can be written as <span class="math inline">\(\mathbf{A}^{1/2} = \boldsymbol{\Phi}\textrm{diag}(\lambda_1^{1/2},\ldots,\lambda_p^{1/2}) \boldsymbol{\Phi}'\)</span> and <span class="math inline">\(\mathbf{A}^{-1/2} = \boldsymbol{\Phi}\textrm{diag}(\lambda_1^{-1/2},\ldots,\lambda_p^{-1/2}) \boldsymbol{\Phi}'\)</span>, respectively.</p>
<p><strong>Singular value decomposition</strong> (SVD). Let <span class="math inline">\(\mathbf{A}\)</span> be a <span class="math inline">\(p \times n\)</span> matrix of real values. Then the matrix <span class="math inline">\(\mathbf{A}\)</span> can be decomposed as <span class="math inline">\(\mathbf{A}= \mathbf{U}\mathbf{D}\mathbf{V}'\)</span>, where <span class="math inline">\(\mathbf{U}\)</span> and <span class="math inline">\(\mathbf{V}\)</span> are <span class="math inline">\(p \times p\)</span> and <span class="math inline">\(n \times n\)</span> orthogonal matrices, respectively. In addition, the <span class="math inline">\(p \times n\)</span> matrix <span class="math inline">\(\mathbf{D}\)</span> contains all zeros except for the <span class="math inline">\((k,k)\)</span>th non-negative elements, <span class="math inline">\(\{d_k: \; k=1,2,\ldots,\min(p,n)\}\)</span>, which are known as <em>singular values</em>.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-johnson1992applied" class="csl-entry" role="listitem">
Johnson, R. A., &amp; Wichern, D. W. (1992). Applied multivariate statistical analysis. In <em>Prentice Hall</em> (3rd ed.). Prentice Hall.
</div>
<div id="ref-schott2016matrix" class="csl-entry" role="listitem">
Schott, J. R. (2017). <em>Matrix analysis for statistics</em> (3rd ed.). John Wiley &amp; Sons.
</div>
</div>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./references.html" class="pagination-link" aria-label="References">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">References</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ChapterAppendixB.html" class="pagination-link" aria-label="General Smoothing\index{smoothing} Kernels">
        <span class="nav-page-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">General Smoothing Kernels</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>